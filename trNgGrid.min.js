var TrNgGrid;(function(n){var t;(function(n){n.tableDirective="trNgGrid";n.tableDirectiveAttribute="data-tr-ng-grid";n.dataColumnIsAutoGeneratedAttribute=n.tableDirectiveAttribute+"-auto-generated";n.dataColumnIsAutoGeneratedField=n.tableDirective+"AutoGenerated";n.dataColumnIsCustomizedAttribute=n.tableDirectiveAttribute+"-customized";n.dataColumnIsCustomizedField=n.tableDirective+"Customized";n.sortFilter=n.tableDirective+"SortFilter";n.dataPagingFilter=n.tableDirective+"DataPagingFilter";n.translateFilter=n.tableDirective+"TranslateFilter";n.dataFormattingFilter=n.tableDirective+"DataFormatFilter";n.defaultTranslationLocale="default";n.bodyDirective=n.tableDirective+"Body";n.bodyDirectiveAttribute=n.tableDirectiveAttribute+"-body";n.headerDirective=n.tableDirective+"Header";n.headerDirectiveAttribute=n.tableDirectiveAttribute+"-header";n.footerDirective=n.tableDirective+"Footer";n.footerDirectiveAttribute=n.tableDirectiveAttribute+"-footer";n.rowDirective=n.tableDirective+"Row";n.rowDirectiveAttribute=n.tableDirectiveAttribute+"-row";n.cellDirective=n.tableDirective+"Cell";n.cellDirectiveAttribute=n.tableDirectiveAttribute+"-cell";n.cellPlaceholderDirective=n.cellDirective+"Placeholder";n.cellPlaceholderDirectiveAttribute=n.cellDirectiveAttribute+"-placeholder";n.globalFilterDirective=n.tableDirective+"GlobalFilter";n.globalFilterDirectiveAttribute=n.tableDirectiveAttribute+"-global-filter";n.pagerDirective=n.tableDirective+"Pager";n.pagerDirectiveAttribute=n.tableDirectiveAttribute+"-pager";n.columnSortDirective=n.tableDirective+"ColumnSort";n.columnSortDirectiveAttribute=n.tableDirectiveAttribute+"-column-sort";n.columnFilterDirective=n.tableDirective+"ColumnFilter";n.columnFilterDirectiveAttribute=n.tableDirectiveAttribute+"-column-filter";n.gridConfigurationService=n.tableDirective+"Configuration";n.gridConfigurationProvider=n.gridConfigurationService+"Provider"})(t=n.Constants||(n.Constants={}))})(TrNgGrid||(TrNgGrid={})),function(n){function u(n,t,i){var r={},u=n instanceof Array;angular.forEach(t,function(t,i){var f=u?n[i]:n[t];f!==undefined&&(f==="true"?f=!0:f==="false"&&(f=!1),r[t]=f)});i(r)}function c(n,t,r,f,e){var o,s;o=f instanceof Array?f:i(f);s=new Array(o.length);angular.forEach(o,function(n,i){var r=t[n];s[i]=r});r.$watchGroup(s,function(n){return u(n,o,e)})}function l(n,t,r){var f;f=t instanceof Array?t:i(t);n.$watchGroup(f,function(){return u(n,f,r)})}function i(n){var t=[];for(var i in n)t.push(i);return t}function t(n,t){var r,i,u;for(t=t.toUpperCase(),r=n.children(),i=0;i<r.length;i++)if(u=r[i],u.tagName===t)return angular.element(u);return null}function a(n){for(var r=n.parent(),i=r.children(),t=0;t<i.length&&i[t]===n[0];t++);return t>=i.length?-1:t}function r(n,t){var r,u,i,f;for(t=t.toUpperCase(),r=[],u=n.children(),i=0;i<u.length;i++)f=u[i],f.tagName===t&&r.push(angular.element(f));return r}function v(n,t){var i=n.children(),r;i.length===1&&angular.element(i[0]).attr(t)||(r=angular.element("<div>"+n.html()+"<\/div>").attr(t,""),n.empty(),n.append(r))}function f(t){console.log(n.Constants.tableDirective+"("+(new Date).getTime()+"): "+t)}function e(){return t(t(angular.element("<table><tbody><tr><\/tr><\/tbody><\/table>"),"tbody"),"tr")}function o(n){return t(t(t(angular.element("<table><tbody><tr><"+n+"><\/"+n+"><\/tr><\/tbody><\/table>"),"tbody"),"tr"),n)}function s(t,i,r,u){var f,e,s;return i||(i=o(r),i.attr(n.Constants.dataColumnIsAutoGeneratedAttribute,"true")),i.attr(u,""),f=i.children(),e=f.length||i.html().replace(/^\s+|\s+$/gm,""),e&&f.length===0&&(s=angular.element("<div>"+i.html()+"<\/div>"),i.empty(),i.append(s)),e&&i.attr(n.Constants.dataColumnIsCustomizedAttribute,"true"),i}function h(t,i,u,f,o){var h,l=r(i,"tr"),a,c,v,y,p;for(l.length||(i.empty(),h=e(),i.append(h),l.push(h)),a=0;a<l.length;a++)for(h=l[a],h.attr(u,""),c=r(h,f),c.length!==0&&c[0].attr(n.Constants.cellPlaceholderDirectiveAttribute)||(v=angular.element(t.templates.headerCellStandard),v.attr("data-ng-repeat","gridColumnLayout in (gridLayoutRow.cells)"),v.attr(n.Constants.cellPlaceholderDirectiveAttribute,""),h.prepend(v)),y=0;y<c.length;y++)p=c[y],s(t,p,f,o)}function y(i,r){var u=t(r,"thead"),e,o;u||(u=t(angular.element("<table><thead><\/thead><\/table"),"thead"),r.prepend(u));u.attr(n.Constants.headerDirectiveAttribute,"");h(i,u,n.Constants.rowDirectiveAttribute,"th",n.Constants.cellDirectiveAttribute);e=t(r,"tfoot");e||(e=t(angular.element("<table><tfoot><\/tfoot><\/table"),"tfoot"),u.after(e));o=t(r,"tbody");o||(o=t(angular.element("<table><tbody><\/tbody><\/table"),"tbody"),e.after(o));angular.forEach(r.children,function(n){(n!==u[0]||n!==o[0]||n!==e[0])&&(angular.element(n).remove(),i.debugMode&&f("Invalid extra element found inside the grid template structure: "+n.tagName))})}n.monitorAttributes=c;n.monitorScope=l;n.extractFields=i;n.findChildByTagName=t;n.findChildIndex=a;n.findChildrenByTagName=r;n.wrapTemplatedCell=v;n.log=f;n.createRowElement=e;n.createCellElement=o;n.fixGridCell=s;n.fixGridSection=h;n.fixTableStructure=y}(TrNgGrid||(TrNgGrid={})),function(n){var t,r,i;(function(n){n[n.None=0]="None";n[n.SingleRow=1]="SingleRow";n[n.MultiRow=2]="MultiRow";n[n.MultiRowWithKeyModifiers=3]="MultiRowWithKeyModifiers"})(n.SelectionMode||(n.SelectionMode={}));t=n.SelectionMode;r=function(){function n(){}return n}();n.IGridRow=r;i=function(){function i(n,t,i,r){this.$compile=n;this.$parse=t;this.$timeout=i;this.gridConfiguration=r;this.nonFieldNameTagIndex=0;this.nonFieldNameFormat="$$_trNgGridCustom_";this.gridColumns={}}return i.prototype.setGridOptions=function(i){var r=this,u,f;this.gridOptions=i;this.gridLayout=new n.GridLayout(this.gridConfiguration,this.gridOptions);this.gridOptions.onDataRequired&&(u=function(){r.dataRequestPromise=null;r.gridOptions.immediateDataRetrieval=!1;r.gridOptions.onDataRequired(r.gridOptions)},f=function(){r.dataRequestPromise&&(r.$timeout.cancel(r.dataRequestPromise),r.dataRequestPromise=null);r.gridOptions.immediateDataRetrieval?u():r.dataRequestPromise=r.$timeout(function(){u()},r.gridOptions.onDataRequiredDelay,!0)},this.gridOptions.$watch("currentPage",function(n,t){n!==t&&f()}),this.gridOptions.$watchCollection("[filterBy, filterByFields, orderBy, orderByReverse, pageItems, ]",function(){if(r.gridOptions.currentPage!==0){r.gridOptions.currentPage=0;return}f()}),this.gridOptions.$watch("immediateDataRetrieval",function(n){n&&r.dataRequestPromise&&(r.$timeout.cancel(r.dataRequestPromise),u())}));this.gridOptions.$watch("selectionMode",function(n,i){if(n!==i)switch(n){case t[0]:r.gridOptions.selectedItems.splice(0);break;case t[1]:r.gridOptions.selectedItems.length>1&&r.gridOptions.selectedItems.splice(1)}})},i.prototype.setColumnOptions=function(n){if(n.isLinkedToField=!!n.fieldName||n.fieldName.indexOf(this.nonFieldNameFormat)<0,n.fieldName||(n.fieldName=this.nonFieldNameFormat+this.nonFieldNameTagIndex++),n.displayItemFieldName=n.fieldName.replace(/[^a-zA-Z]/g,"_"),n.displayName)n.columnTitle=n.displayName;else if(n.isLinkedToField){var i=n.fieldName.replace(/^([^\a-zA-Z]*)([\a-zA-Z]*)(.*)/g,"$2"),t=i.split(/(?=[A-Z])/);t.length&&t[0].length&&(t[0]=t[0][0].toLocaleUpperCase()+t[0].substr(1));n.columnTitle=t.join(" ")}else n.columnTitle="";return this.gridColumns[n.fieldName]=angular.extend(this.gridColumns[n.fieldName]||{},this.gridConfiguration.defaultColumnOptions,n)},i.prototype.getColumnOptions=function(n){return this.gridColumns[n]},i.prototype.speedUpAsyncDataRetrieval=function(n){n&&n.keyCode!=13||(this.gridOptions.immediateDataRetrieval=!0)},i.prototype.toggleSorting=function(n){this.gridOptions.orderBy!=n?this.gridOptions.orderBy=n:this.gridOptions.orderByReverse=!this.gridOptions.orderByReverse;this.speedUpAsyncDataRetrieval()},i.prototype.getFormattedFieldName=function(){},i.prototype.setFilter=function(){},i.prototype.toggleItemSelection=function(n,i,r){var h,f,c,e,l,o,s,u;if(this.gridOptions.selectionMode!==t[0])switch(this.gridOptions.selectionMode){case t[3]:if(r.ctrlKey||r.shiftKey||r.metaKey){if(r.ctrlKey||r.metaKey)u=this.gridOptions.selectedItems.indexOf(i),u>=0?this.gridOptions.selectedItems.splice(u,1):this.gridOptions.selectedItems.push(i);else if(r.shiftKey){for(document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&(h=window.getSelection(),h.removeAllRanges()),c=this.gridOptions.selectedItems[this.gridOptions.selectedItems.length-1],f=0;f<n.length&&n[f].$$_gridItem!==c;f++);for(f>=n.length&&(f=0),e=0;e<n.length&&n[e].$$_gridItem!==i;e++);if(e>=n.length)throw"Invalid selection on a key modifier selection mode";for(e<f&&(l=f,f=e,e=l),o=f;o<=e;o++)s=n[o].$$_gridItem,this.gridOptions.selectedItems.indexOf(s)<0&&this.gridOptions.selectedItems.push(s)}}else u=this.gridOptions.selectedItems.indexOf(i),this.gridOptions.selectedItems.splice(0),u<0&&this.gridOptions.selectedItems.push(i);break;case t[1]:u=this.gridOptions.selectedItems.indexOf(i);this.gridOptions.selectedItems.splice(0);u<0&&this.gridOptions.selectedItems.push(i);break;case t[2]:u=this.gridOptions.selectedItems.indexOf(i);u>=0?this.gridOptions.selectedItems.splice(u,1):this.gridOptions.selectedItems.push(i)}},i.prototype.computeFormattedItems=function(){},i.prototype.computeFilteredItems=function(){},i.prototype.setupDisplayItemsArray=function(){},i}();n.GridController=i;n.gridModule=angular.module(n.Constants.tableDirective,[]);n.gridModule.directive(n.Constants.tableDirective,[n.Constants.gridConfigurationService,function(t){return{restrict:"A",scope:{items:"=",selectedItems:"=?",filterBy:"=?",filterByFields:"=?",orderBy:"=?",orderByReverse:"=?",pageItems:"=?",currentPage:"=?",totalItems:"=?",enableFiltering:"=?",enableSorting:"=?",selectionMode:"@",locale:"@",onDataRequired:"&",onDataRequiredDelay:"=?",fields:"=?"},controller:["$compile","$parse","$timeout",n.Constants.gridConfigurationService,i],compile:function(i){return n.fixTableStructure(t,i),{pre:function(n,t,i,r){r.setGridOptions(n)}}}}}])}(TrNgGrid||(TrNgGrid={})),function(n){var r=function(){function n(){this.minifiedPageCountThreshold=3}return n}(),u=function(){function n(){this.tableCssClass="tr-ng-grid table table-bordered table-hover ";this.cellCssClass="tr-ng-cell ";this.headerCellCssClass="tr-ng-cell tr-ng-column-header ";this.bodyCellCssClass="tr-ng-cell ";this.columnTitleCssClass="tr-ng-title ";this.columnSortCssClass="tr-ng-sort pull-right pull-top ";this.columnFilterInputWrapperCssClass=" ";this.columnFilterCssClass="tr-ng-column-filter ";this.columnSortActiveCssClass="tr-ng-sort-active text-info ";this.columnSortInactiveCssClass="tr-ng-sort-inactive text-muted glyphicon glyphicon-chevron-down ";this.columnSortReverseOrderCssClass="tr-ng-sort-order-reverse glyphicon glyphicon-chevron-down ";this.columnSortNormalOrderCssClass="tr-ng-sort-order-normal glyphicon glyphicon-chevron-up ";this.rowSelectedCssClass="active ";this.footerCssClass="tr-ng-grid-footer form-inline "}return n}(),t=function(){function n(){this.fieldName=undefined;this.cellWidth=undefined;this.cellHeight=undefined;this.displayAlign="left";this.displayFormat=undefined;this.displayName=undefined;this.filter=undefined;this.enableFiltering=!0;this.enableSorting=!0}return n}(),i,f;n.GridConfigurationDefaultColumnOptions=t;i=function(){function t(t,i){var r=t.startSymbol(),u=t.endSymbol();this.headerCellStandard="<th><\/th>";this.headerCellContentsStandard='<div class="'+i.headerCellCssClass+'" >  <div '+n.Constants.columnSortDirectiveAttribute+'=""><\/div>  <a '+i.columnTitleCssClass+'"     href="" ng-click="((gridOptions.enableSorting&&gridColumnOptions.enableSorting!==false)||gridColumnOptions.enableSorting)&&toggleSorting(gridColumnOptions.fieldName)">      '+r+"gridColumnOptions.columnTitle |"+n.Constants.translateFilter+":gridOptions.locale"+u+"  <\/a>  <div "+n.Constants.columnFilterDirectiveAttribute+'=""><\/div><\/div>';this.bodyCellStandard='<div ng-attr-class="'+i.bodyCellCssClass+' text-{{columnOptions.displayAlign}}" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""><\/div>  <\/div>  <div ng-switch-default>{{gridDisplayItem[columnOptions.displayFieldName]}}<\/div><\/div>';this.footerCellStandard='<div class="'+i.footerCssClass+'" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""><\/div>  <\/div>  <div ng-switch-default>    <span '+n.Constants.globalFilterDirectiveAttribute+'=""><\/span>    <span '+n.Constants.pagerDirectiveAttribute+'=""><\/span>  <\/div><\/div>';this.columnFilter='<div ng-show="(gridOptions.enableFiltering&&columnOptions.enableFiltering!==false)||columnOptions.enableFiltering" class="'+i.columnFilterCssClass+'"> <div class="'+i.columnFilterInputWrapperCssClass+'">   <input class="form-control input-sm" type="text" ng-model="columnOptions.filter" ng-keypress="speedUpAsyncDataRetrieval($event)"><\/input> <\/div><\/div>';this.columnSort='<a href="" ng-attr-title="{{\'Sort\'|'+n.Constants.translateFilter+':gridOptions.locale}}" ng-show="(gridOptions.enableSorting&&columnOptions.enableSorting!==false)||columnOptions.enableSorting" ng-click="toggleSorting(columnOptions.fieldName)" class="'+i.columnSortCssClass+'" >   <span ng-class="{\''+i.columnSortActiveCssClass+"':gridOptions.orderBy==columnOptions.fieldName,'"+i.columnSortInactiveCssClass+"':gridOptions.orderBy!=columnOptions.fieldName,'"+i.columnSortNormalOrderCssClass+"':gridOptions.orderBy==columnOptions.fieldName&&!gridOptions.orderByReverse,'"+i.columnSortReverseOrderCssClass+"':gridOptions.orderBy==columnOptions.fieldName&&gridOptions.orderByReverse}\" >  <\/span><\/a>";this.footerGlobalFilter='<span ng-show="gridOptions.enableFiltering" class="pull-left form-group">  <input class="form-control" type="text" ng-model="gridOptions.filterBy" ng-keypress="speedUpAsyncDataRetrieval($event)" ng-attr-placeholder="{{\'Search\'|'+n.Constants.translateFilter+':gridOptions.locale}}"><\/input><\/span>';this.footerPager='<span class="pull-right form-group"> <ul class="pagination">   <li ng-class="{disabled:gridOptions.currentPage==0}" ng-if="isPaged&&!pageRangeFullCoverage">     <a href="" ng-click="gridOptions.currentPage!=0&&navigateToPage(0)" ng-attr-title="{{\'First Page\'|'+n.Constants.translateFilter+':gridOptions.locale}}">         <span>&laquo;<\/span>     <\/a>   <\/li>   <li ng-class="{disabled:gridOptions.currentPage==0}" ng-if="isPaged&&!pageRangeFullCoverage">     <a href="" ng-click="gridOptions.currentPage!=0&&navigateToPage(gridOptions.currentPage - 1)" ng-attr-title="{{\'Previous Page\'|'+n.Constants.translateFilter+':gridOptions.locale}}">         <span>&lsaquo;<\/span>     <\/a>   <\/li>   <li ng-if="isPaged&&!pageRangeFullCoverage&&visiblePageRange[0]!=0"class="disabled">      <span>...<\/span>   <\/li>   <li ng-if="isPaged" ng-repeat="pageIndex in visiblePageRange track by $index" ng-class="{active:pageIndex===gridOptions.currentPage}">      <a href="" ng-click="navigateToPage(pageIndex)" ng-attr-title="{{\'Page\'|'+n.Constants.translateFilter+':gridOptions.locale}}">{{pageIndex+1}}<\/a>   <\/li>   <li ng-if="isPaged&&!pageRangeFullCoverage&&visiblePageRange[visiblePageRange.length-1]!=lastPage" class="disabled">      <span>...<\/span>   <\/li>   <li ng-class="{disabled:gridOptions.currentPage==lastPage}" ng-if="isPaged&&!pageRangeFullCoverage">     <a href="" ng-click="gridOptions.currentPage!=lastPage&&navigateToPage(gridOptions.currentPage + 1)" ng-attr-title="{{\'Next Page\'|'+n.Constants.translateFilter+':gridOptions.locale}}">         <span>&rsaquo;<\/span>     <\/a>   <\/li>   <li ng-class="{disabled:gridOptions.currentPage==lastPage}" ng-if="isPaged&&!pageRangeFullCoverage">     <a href="" ng-click="gridOptions.currentPage!=lastPage&&navigateToPage(lastPage)" ng-attr-title="{{\'Last Page\'|'+n.Constants.translateFilter+':gridOptions.locale}}">         <span>&raquo;<\/span>     <\/a>   <\/li>   <li class="disabled" style="white-space: nowrap;">     <span ng-hide="totalItemsCount">{{\'No items to display\'|'+n.Constants.translateFilter+":gridOptions.locale}}<\/span>     <span ng-show=\"totalItemsCount\">       {{visibleStartItemIndex+1}} - {{visibleEndItemIndex+1}} {{'displayed'|"+n.Constants.translateFilter+":gridOptions.locale}}       <span>, {{totalItemsCount}} {{'in total'|"+n.Constants.translateFilter+":gridOptions.locale}}<\/span>     <\/span >    <\/li> <\/ul><\/span>"}return t}();f=function(){function f(n){var t=this;this.$interpolateProvider=n;this.$get=[function(){return{styles:t.styles(),defaultColumnOptions:t.defaultColumnOptions(),translations:t.gridTranslations,pagerOptions:t.pagerOptions(),templates:t.templates(),debugMode:t.debugMode()}}];this.gridTranslations={};this.gridDebugMode=!0}return f.prototype.styles=function(n){return n&&(this.gridStyles=angular.extend({},new u,n)),angular.extend({},this.gridStyles||new u)},f.prototype.defaultColumnOptions=function(n){return n&&(this.gridDefaultColumnOptions=angular.extend({},new t,n)),angular.extend({},this.gridDefaultColumnOptions||new t)},f.prototype.translations=function(n,t){var i=this.gridTranslations[n]=angular.extend({},this.gridTranslations[n],t);return angular.extend({},i)},f.prototype.defaultTranslations=function(t){return this.translations(n.Constants.defaultTranslationLocale,t)},f.prototype.pagerOptions=function(n){return n&&(this.gridPagerOptions=angular.extend({},new r,n)),angular.extend({},this.gridPagerOptions||new r)},f.prototype.templates=function(n){return n&&(this.gridTemplates=angular.extend({},new i(this.$interpolateProvider,this.styles()),n)),angular.extend({},this.gridTemplates||new i(this.$interpolateProvider,this.styles()))},f.prototype.debugMode=function(n){return n!==undefined&&(this.gridDebugMode=!!n),this.gridDebugMode},f}();n.gridModule.provider(n.Constants.gridConfigurationService,f)}(TrNgGrid||(TrNgGrid={})),function(n){var e,t,i,r,u,f;(function(n){n[n.Enforced=0]="Enforced";n[n.Header=1]="Header";n[n.Body=2]="Body"})(n.GridSectionType||(n.GridSectionType={}));e=n.GridSectionType;t=function(){function n(){this.fieldName=undefined;this.colspan=undefined;this.isCustomized=undefined;this.isAutoGenerated=undefined;this.isLinkedToField=undefined;this.isDeactivated=undefined;this.placeholder=undefined}return n}();n.DefaultGridColumnLayoutOptions=t;i=function(){function t(n,t,i){this.gridConfiguration=n;this.gridLayout=t;this.gridSectionType=i;this.cells=[]}return t.prototype.swapCells=function(t,i){var r=this.cells[t],u=this.cells[i];this.gridConfiguration.debugMode&&n.log("About to swap cells ["+r.fieldName+"] and ["+u.fieldName+"] in section "+this.gridSectionType);this.cells.splice(t,1,u);this.cells.splice(i,1,r)},t.prototype.findCell=function(n){for(var t=0;t<this.cells.length;t++)if(this.cells[t].fieldName===n)return this.cells[t];return null},t.prototype.registerCell=function(t,i){var u,r;if(!t.fieldName)throw"A field name was not provided";if(u=!1,i===undefined)for(r=0;r<this.cells.length&&!u;r++)this.cells[r].fieldName===t.fieldName&&(this.gridConfiguration.debugMode&&n.log("A layout cell ["+t.fieldName+"] is about to be updated in section "+this.gridSectionType),this.cells[r]=t,u=!0);u||(this.gridConfiguration.debugMode&&n.log("A new layout cell ["+t.fieldName+"] is about to be registered in section "+this.gridSectionType),i===undefined||i===this.cells.length?this.cells.push(t):this.cells.splice(i,0,t));this.gridLayout.triggerReconciliation()},t.prototype.unregisterCell=function(t){for(var i=0;i<this.cells.length;i++)if(this.cells[i]===t){this.gridConfiguration.debugMode&&n.log("A layout cell ["+t.fieldName+"] is about to get unregistered in section "+this.gridSectionType);this.cells.splice(i,1);this.gridLayout.triggerReconciliation();return}},t}();n.GridLayoutRow=i;r=function(){function t(n,t,i){this.gridConfiguration=n;this.gridLayout=t;this.gridSectionType=i;this.rows=[]}return t.prototype.registerRow=function(){var t=new i(this.gridConfiguration,this.gridLayout,this.gridSectionType);return this.rows.push(t),this.gridConfiguration.debugMode&&n.log("A new layout row ["+this.rows.length+"] was registered in section "+this.gridSectionType),this.gridLayout.triggerReconciliation(),t},t.prototype.unregisterRow=function(t){for(var i=0;i<this.rows.length;i++)if(this.rows[i]===t){this.rows.splice(i,1);this.gridConfiguration.debugMode&&n.log("A layout row was unregistered in section "+this.gridSectionType);this.gridLayout.triggerReconciliation();return}},t.prototype.clear=function(){this.rows.splice(0);this.gridConfiguration.debugMode&&n.log("Layout section "+this.gridSectionType+" got cleared");this.gridLayout.triggerReconciliation()},t}();n.GridLayoutSection=r;u=function(){function i(n,t){this.gridConfiguration=n;this.gridOptions=t;this.sections=new Array(3);this.reconciliationTriggerKey="triggerGridReconciliation";this.reconciling=!1;this.setupListeners()}return i.prototype.getSection=function(t){var i=this.sections[t];return i||(this.sections[t]=i=new r(this.gridConfiguration,this,t),this.gridConfiguration.debugMode&&n.log("A new layout section ["+t+"] was registered"),this.triggerReconciliation()),i},i.prototype.triggerReconciliation=function(){this.gridOptions[this.reconciliationTriggerKey]=!0},i.prototype.setupListeners=function(){var i=this,t;this.gridOptions.$watch(this.reconciliationTriggerKey,function(n){n&&i.gridOptions.$applyAsync(function(){i.reconcile()})});t=null;t=this.gridOptions.$watch("items.length",function(r){r&&(i.enforceFields(n.extractFields(i.gridOptions.items[0])),t&&(t(),t=null))});this.gridOptions.fields&&(this.enforceFields(this.gridOptions.fields),t&&(t(),t=null));this.gridOptions.$watchCollection("fields",function(n,r){angular.equals(n,r)||(i.enforceFields(n||[]),t&&(t(),t=null))})},i.prototype.enforceFields=function(n){var i=this.getSection(0),r;n?(i.clear(),r=i.registerRow(),angular.forEach(n,function(n){var i=new t;i.fieldName=n;i.isAutoGenerated=!0;i.isLinkedToField=!0;r.registerCell(i)})):i.clear()},i.prototype.reconcile=function(){var f=this,u,t,i,r;try{for(this.gridConfiguration.debugMode&&n.log("Starting to reconcile all the rows"),u=[],t=0;t<=1&&u.length===0;t++)angular.forEach(this.getSection(t).rows,function(n){angular.forEach(n.cells,function(n){n.isLinkedToField&&u.push(n.fieldName)})});for(i=[],t=0;t<=2;t++)angular.forEach(this.getSection(t).rows,function(n){t!==0&&f.cleanupRowForReconciliation(n,u);i.push(n)});for(r=0;r<i.length-1;r++)this.reconcileRows(i[r],i[r+1])}finally{this.gridOptions[this.reconciliationTriggerKey]=!1}},i.prototype.reconcileRows=function(n,t){for(var f,e,i,u,o,r=0,s=0;s<n.cells.length;s++)if(f=n.cells[s],!f.isDeactivated){for(e=!0,u=r;e&&u<t.cells.length;u++)i=t.cells[u],!i||i.isDeactivated||i.isLinkedToField!=f.isLinkedToField||i.isLinkedToField&&i.fieldName!==f.fieldName||(e=!1);e?(i=angular.extend({},f),i.isAutoGenerated=!0,i.isCustomized=!1,t.registerCell(i,r)):(u--,u!==r&&t.swapCells(u,r));r++}while(r<t.cells.length)o=t.cells[r],o.isAutoGenerated?t.unregisterCell(o):(o.isDeactivated=!0,r++)},i.prototype.cleanupRowForReconciliation=function(n,t){for(var i,r=0;r<n.cells.length;r++)i=n.cells[r],i.isAutoGenerated?(n.unregisterCell(i),r--):i.isDeactivated=i.isLinkedToField&&t.indexOf(i.fieldName)<0},i}();n.GridLayout=u;f=function(){function i(){}return i.prototype.prepareColumnSettingsScope=function(i,r){var f=this,u;r.$on("$destroy",function(){i.$destroy()});u=!1;n.monitorScope(r,new n.GridConfigurationDefaultColumnOptions,function(e){f.registerColumnOptions(i,e);u||(n.monitorScope(r,new t,function(n){n.isLinkedToField=i.gridColumnOptions.isLinkedToField;f.registerColumnLayoutOptions(i,n)}),u=!0)})},i.prototype.prepareAutoGeneratedColumnScope=function(n){if(!n.gridColumnLayout)throw"Expecting a grid column layout for the auto-generated cell";n.gridColumnOptions=n.grid.getColumnOptions(n.gridColumnLayout.fieldName);n.gridColumnOptions||(n.gridColumnOptions={fieldName:n.gridColumnLayout.fieldName},n.grid.setColumnOptions(n.gridColumnOptions))},i.prototype.registerColumnOptions=function(n,t){t=n.grid.setColumnOptions(t);n.gridColumnOptions=t},i.prototype.registerColumnLayoutOptions=function(n,t){t.isAutoGenerated?t=n.gridLayoutRow.findCell(t.fieldName):n.gridLayoutRow.registerCell(t);n.gridColumnLayout=t},i}();n.GridColumnController=f}(TrNgGrid||(TrNgGrid={})),function(n){n.gridModule.directive(n.Constants.headerDirective,[function(){return{restrict:"A",scope:!0,require:"^"+n.Constants.tableDirective,link:{pre:function(t,i,r,u){t.grid=u;t.gridOptions=u.gridOptions;t.gridLayoutSection=u.gridLayout.getSection(n.GridSectionType.Header)}}}}]);n.gridModule.directive(n.Constants.rowDirective,["$compile",n.Constants.gridConfigurationService,function(){return{restrict:"A",scope:!0,require:"^"+n.Constants.tableDirective,compile:function(){return{pre:function(n){n.gridLayoutRow=n.gridLayoutSection.registerRow();n.$on("$destroy",function(){n.gridLayoutSection.unregisterRow(n.gridLayoutRow)})},post:function(){}}}}}]);n.gridModule.directive(n.Constants.cellPlaceholderDirective,["$compile","$interpolate",n.Constants.gridConfigurationService,function(t,i,r){return{restrict:"A",require:[n.Constants.cellPlaceholderDirective,"^"+n.Constants.tableDirective],controller:[n.GridColumnController],transclude:"element",compile:function(){return{pre:function(n,t){n.gridColumnLayout.placeholder=t},post:function(i,u,f,e){var h=e[0];if(i.gridColumnLayout.isAutoGenerated){h.prepareAutoGeneratedColumnScope(i);var c=!1,o=null,s=function(){if(o&&(r.debugMode&&n.log("Removing auto-generated cell for field "+i.gridColumnLayout.fieldName),o.remove(),o=null),i.gridColumnLayout&&i.gridColumnOptions){r.debugMode&&n.log("Creating auto-generated cell for field "+i.gridColumnLayout.fieldName);var f=angular.element(r.templates.headerCellStandard);f.append(angular.element(r.templates.headerCellContentsStandard));u.after(f);o=t(f)(i)}};i.$watchGroup(["gridColumnLayout","gridColumnOptions"],function(){s()});i.$on("$destroy",function(){c=!0;s();i.gridColumnLayout.placeholder=null})}}}}}}]);n.gridModule.directive(n.Constants.cellDirective,["$compile",n.Constants.gridConfigurationService,function(t,i){return{restrict:"A",require:[n.Constants.cellDirective,"^"+n.Constants.tableDirective],controller:[n.GridColumnController],scope:{isCustomized:"@"+n.Constants.dataColumnIsCustomizedField,fieldName:"@",displayName:"@",displayAlign:"@",displayFormat:"@",enableSorting:"@",enableFiltering:"@",cellWidth:"@",cellHeight:"@",filter:"@",colspan:"@"},transclude:"element",replace:!0,template:'<td style="display:none"><\/td>',compile:function(){return{pre:function(){},post:function(r,u,f,e,o){var a=e[0],s=r.$parent.$new();a.prepareColumnSettingsScope(s,r);var h=null,c=!1,l=function(){h&&(i.debugMode&&n.log("Removing tanscluded cell for field "+s.gridColumnLayout.fieldName),h.remove(),h=null);!c&&s.gridColumnLayout&&s.gridColumnLayout.placeholder&&s.gridColumnOptions&&(i.debugMode&&n.log("Transcluding and attaching cell for field "+s.gridColumnLayout.fieldName),console.log(u),o(s,function(n){if(h=n,s.gridColumnLayout.placeholder.after(h),!s.gridColumnLayout.isCustomized){var r=angular.element(i.templates.headerCellContentsStandard);h.append(r);t(r)(s)}},s.gridColumnLayout.placeholder.parent()))};s.$watchGroup(["gridColumnLayout","gridColumnOptions","gridColumnLayout.placeholder"],function(){l()});s.$on("$destroy",function(){c=!0;l()})}}}}}])}(TrNgGrid||(TrNgGrid={})),function(n){n.gridModule.filter(n.Constants.sortFilter,["$filter","$parse",function(n,t){return function(i,r,u){if(!r.orderBy||!u)return i;return n("orderBy")(i,function(n){var i=undefined;try{i=t("item.trNgGridDataItem."+r.orderBy)({item:n})}catch(f){}if(i===undefined)try{i=t("item."+u.displayFieldName)({item:n})}catch(f){}return i},r.orderByReverse)}}]).filter(n.Constants.dataPagingFilter,function(){return function(n,t){var i,r;return(n&&(t.totalItems=n.length),!t.pageItems||!n||n.length===0)?n:(t.currentPage||(t.currentPage=0),i=t.currentPage*t.pageItems,i>=n.length&&(t.currentPage=0,i=0),r=t.currentPage*t.pageItems+t.pageItems,n.slice(i,r))}}).filter(n.Constants.translateFilter,["$filter","$injector",n.Constants.gridConfigurationService,function(t,i,r){function u(t,i){for(var s,e,f=null,o=t.split(/[-_]/),u=o.length;u>=0&&!f;u--)s=u===0?n.Constants.defaultTranslationLocale:o.slice(0,u).join("-"),e=r.translations[s],e&&(f=i(e));return f}return function(r,f){var e,o;if(!r)return r;if(f||(f=n.Constants.defaultTranslationLocale),r instanceof Date)return o=u(f,function(n){return n.localeDateFormat}),t("date")(r,o);if(e=u(f,function(n){return n[r]}),!e&&i.has("translateFilter"))try{e=t("translate")(r)}catch(s){}return e||(e=r),e}}])}(TrNgGrid||(TrNgGrid={}));