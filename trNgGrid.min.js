var TrNgGrid;(function(n){var t;(function(n){n.tableDirective="trNgGrid";n.tableDirectiveAttribute="data-tr-ng-grid";n.dataColumnIsAutoGeneratedAttribute=n.tableDirectiveAttribute+"-auto-generated";n.dataColumnIsAutoGeneratedField=n.tableDirective+"AutoGenerated";n.dataColumnIsCustomizedAttribute=n.tableDirectiveAttribute+"-customized";n.dataColumnIsCustomizedField=n.tableDirective+"Customized";n.sortFilter=n.tableDirective+"SortFilter";n.dataPagingFilter=n.tableDirective+"DataPagingFilter";n.translateFilter=n.tableDirective+"TranslateFilter";n.dataFormattingFilter=n.tableDirective+"DataFormatFilter";n.defaultTranslationLocale="default";n.sectionDirective=n.tableDirective+"Section";n.sectionDirectiveAttribute=n.tableDirectiveAttribute+"-section";n.rowDirective=n.tableDirective+"Row";n.rowDirectiveAttribute=n.tableDirectiveAttribute+"-row";n.cellDirective=n.tableDirective+"Cell";n.cellDirectiveAttribute=n.tableDirectiveAttribute+"-cell";n.cellPlaceholderDirective=n.cellDirective+"Placeholder";n.cellPlaceholderDirectiveAttribute=n.cellDirectiveAttribute+"-placeholder";n.globalFilterDirective=n.tableDirective+"GlobalFilter";n.globalFilterDirectiveAttribute=n.tableDirectiveAttribute+"-global-filter";n.pagerDirective=n.tableDirective+"Pager";n.pagerDirectiveAttribute=n.tableDirectiveAttribute+"-pager";n.columnSortDirective=n.tableDirective+"ColumnSort";n.columnSortDirectiveAttribute=n.tableDirectiveAttribute+"-column-sort";n.columnFilterDirective=n.tableDirective+"ColumnFilter";n.columnFilterDirectiveAttribute=n.tableDirectiveAttribute+"-column-filter";n.gridConfigurationService=n.tableDirective+"Configuration";n.gridLoggingService=n.tableDirective+"Log";n.gridConfigurationProvider=n.gridConfigurationService+"Provider"})(t=n.Constants||(n.Constants={}))})(TrNgGrid||(TrNgGrid={})),function(n){function r(n,t,i){var r={},u=n instanceof Array;angular.forEach(t,function(t,i){var f=u?n[i]:n[t];f!==undefined&&(f==="true"?f=!0:f==="false"&&(f=!1),r[t]=f)});i(r)}function u(n,t,u,f,e){var s,o=n.startSymbol(),c=n.endSymbol(),h;s=f instanceof Array?f:i(f);h=new Array(s.length);angular.forEach(s,function(n,i){var r=t[n];h[i]=r.length>=o.length&&r.slice(0,o.length)===o?r.slice(o.length,r.length-o.length-c.length):"'"+r+"'"});u.$watchGroup(h,function(n){return r(n,s,e)})}function f(n,t,u){var f;f=t instanceof Array?t:i(t);n.$watchGroup(f,function(){return r(n,f,u)})}function i(n){var t=[];for(var i in n)t.push(i);return t}function t(n,t){var r,i,u;for(t=t.toUpperCase(),r=n.children(),i=0;i<r.length;i++)if(u=r[i],u.tagName===t)return angular.element(u);return null}function e(n){for(var r=n.parent(),i=r.children(),t=0;t<i.length&&i[t]===n[0];t++);return t>=i.length?-1:t}function o(n,t){var r,u,i,f;for(t=t.toUpperCase(),r=[],u=n.children(),i=0;i<u.length;i++)f=u[i],f.tagName===t&&r.push(angular.element(f));return r}function s(n,t){var i=n.children(),r;i.length===1&&angular.element(i[0]).attr(t)||(r=angular.element("<div>"+n.html()+"<\/div>").attr(t,""),n.empty(),n.append(r))}function h(){return t(t(angular.element("<table><tbody><tr><\/tr><\/tbody><\/table>"),"tbody"),"tr")}function c(n){return t(t(t(angular.element("<table><tbody><tr><"+n+"><\/"+n+"><\/tr><\/tbody><\/table>"),"tbody"),"tr"),n)}function l(t,i){var r;switch(i){case n.GridSectionType.Header:r=t.templates.headerCellStandard;break;case n.GridSectionType.Body:r=t.templates.bodyCellStandard;break;case n.GridSectionType.Footer:r=t.templates.footerCellStandard;break;default:throw"Unknown standard template for section cell "+i;}return angular.element(r)}function a(t,i){var r;switch(i){case n.GridSectionType.Header:r=t.templates.headerCellContentsStandard;break;case n.GridSectionType.Body:r=t.templates.bodyCellContentsStandard;break;case n.GridSectionType.Footer:r=t.templates.footerCellContentsStandard;break;default:throw"Unknown standard contents template for section cell"+i;}return angular.element(r)}n.monitorAttributes=u;n.monitorScope=f;n.extractFields=i;n.findChildByTagName=t;n.findChildIndex=e;n.findChildrenByTagName=o;n.wrapTemplatedCell=s;n.createRowElement=h;n.createCellElement=c;n.getStandardCellTemplate=l;n.getStandardCellContentsTemplate=a}(TrNgGrid||(TrNgGrid={})),function(n){var t,i,r;(function(n){n[n.None=0]="None";n[n.SingleRow=1]="SingleRow";n[n.MultiRow=2]="MultiRow";n[n.MultiRowWithKeyModifiers=3]="MultiRowWithKeyModifiers"})(n.SelectionMode||(n.SelectionMode={}));t=n.SelectionMode;i=function(){function n(){}return n}();n.IGridRow=i;r=function(){function i(n,t,i,r,u){this.$compile=n;this.$parse=t;this.$timeout=i;this.gridConfiguration=r;this.loggingService=u;this.nonFieldNameTagIndex=0;this.nonFieldNameFormat="$$_trNgGridCustom_";this.gridColumns={}}return i.prototype.setGridOptions=function(i){var r=this,u,f;this.gridOptions=i;this.gridLayout=new n.GridLayout(this.gridConfiguration,this.loggingService,this.gridOptions);this.gridOptions.onDataRequired&&(u=function(){r.dataRequestPromise=null;r.gridOptions.immediateDataRetrieval=!1;r.gridOptions.onDataRequired(r.gridOptions)},f=function(){r.dataRequestPromise&&(r.$timeout.cancel(r.dataRequestPromise),r.dataRequestPromise=null);r.gridOptions.immediateDataRetrieval?u():r.dataRequestPromise=r.$timeout(function(){u()},r.gridOptions.onDataRequiredDelay,!0)},this.gridOptions.$watch("currentPage",function(n,t){n!==t&&f()}),this.gridOptions.$watchCollection("[filterBy, filterByFields, orderBy, orderByReverse, pageItems, ]",function(){if(r.gridOptions.currentPage!==0){r.gridOptions.currentPage=0;return}f()}),this.gridOptions.$watch("immediateDataRetrieval",function(n){n&&r.dataRequestPromise&&(r.$timeout.cancel(r.dataRequestPromise),u())}));this.gridOptions.$watch("selectionMode",function(n,i){if(n!==i)switch(n){case t[0]:r.gridOptions.selectedItems.splice(0);break;case t[1]:r.gridOptions.selectedItems.length>1&&r.gridOptions.selectedItems.splice(1)}})},i.prototype.setColumnOptions=function(n){if(n.isLinkedToField=!!n.fieldName||n.fieldName.indexOf(this.nonFieldNameFormat)<0,n.fieldName||(n.fieldName=this.nonFieldNameFormat+this.nonFieldNameTagIndex++),n.displayItemFieldName=n.fieldName.replace(/[^a-zA-Z]/g,"_"),n.displayName)n.columnTitle=n.displayName;else if(n.isLinkedToField){var i=n.fieldName.replace(/^([^\a-zA-Z]*)([\a-zA-Z]*)(.*)/g,"$2"),t=i.split(/(?=[A-Z])/);t.length&&t[0].length&&(t[0]=t[0][0].toLocaleUpperCase()+t[0].substr(1));n.columnTitle=t.join(" ")}else n.columnTitle="";return this.gridColumns[n.fieldName]=angular.extend(this.gridColumns[n.fieldName]||{},this.gridConfiguration.defaultColumnOptions,n)},i.prototype.getColumnOptions=function(n){return this.gridColumns[n]},i.prototype.speedUpAsyncDataRetrieval=function(n){n&&n.keyCode!=13||(this.gridOptions.immediateDataRetrieval=!0)},i.prototype.toggleSorting=function(n){this.gridOptions.orderBy!=n?this.gridOptions.orderBy=n:this.gridOptions.orderByReverse=!this.gridOptions.orderByReverse;this.speedUpAsyncDataRetrieval()},i.prototype.getFormattedFieldName=function(){},i.prototype.setFilter=function(){},i.prototype.toggleItemSelection=function(n,i,r){var h,f,c,e,l,o,s,u;if(this.gridOptions.selectionMode!==t[0])switch(this.gridOptions.selectionMode){case t[3]:if(r.ctrlKey||r.shiftKey||r.metaKey){if(r.ctrlKey||r.metaKey)u=this.gridOptions.selectedItems.indexOf(i),u>=0?this.gridOptions.selectedItems.splice(u,1):this.gridOptions.selectedItems.push(i);else if(r.shiftKey){for(document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&(h=window.getSelection(),h.removeAllRanges()),c=this.gridOptions.selectedItems[this.gridOptions.selectedItems.length-1],f=0;f<n.length&&n[f].$$_gridItem!==c;f++);for(f>=n.length&&(f=0),e=0;e<n.length&&n[e].$$_gridItem!==i;e++);if(e>=n.length)throw"Invalid selection on a key modifier selection mode";for(e<f&&(l=f,f=e,e=l),o=f;o<=e;o++)s=n[o].$$_gridItem,this.gridOptions.selectedItems.indexOf(s)<0&&this.gridOptions.selectedItems.push(s)}}else u=this.gridOptions.selectedItems.indexOf(i),this.gridOptions.selectedItems.splice(0),u<0&&this.gridOptions.selectedItems.push(i);break;case t[1]:u=this.gridOptions.selectedItems.indexOf(i);this.gridOptions.selectedItems.splice(0);u<0&&this.gridOptions.selectedItems.push(i);break;case t[2]:u=this.gridOptions.selectedItems.indexOf(i);u>=0?this.gridOptions.selectedItems.splice(u,1):this.gridOptions.selectedItems.push(i)}},i.prototype.computeFormattedItems=function(){},i.prototype.computeFilteredItems=function(){},i.prototype.setupDisplayItemsArray=function(){},i}();n.GridController=r;n.gridModule=angular.module(n.Constants.tableDirective,[])}(TrNgGrid||(TrNgGrid={})),function(n){var t=function(){function t(n){this.gridConfig=n}return t.prototype.log=function(){for(var i=[],t=0;t<arguments.length;t++)i[+t]=arguments[t];i.splice(0,0,n.Constants.tableDirective,"("+new Date+"): ");try{console.info(i)}catch(r){console.log("trNgGrid: Logging failed "+r)}},t}();n.LoggingService=t;n.gridModule.service(n.Constants.gridLoggingService,[n.Constants.gridConfigurationService,t])}(TrNgGrid||(TrNgGrid={})),function(n){var r=function(){function n(){this.minifiedPageCountThreshold=3}return n}(),u=function(){function n(){this.tableCssClass="tr-ng-grid table table-bordered table-hover ";this.cellCssClass="tr-ng-cell ";this.columnTitleCssClass="tr-ng-title ";this.columnSortCssClass="tr-ng-sort pull-right pull-top ";this.columnFilterInputWrapperCssClass=" ";this.columnFilterCssClass="tr-ng-column-filter ";this.columnSortActiveCssClass="tr-ng-sort-active text-info ";this.columnSortInactiveCssClass="tr-ng-sort-inactive text-muted glyphicon glyphicon-chevron-down ";this.columnSortReverseOrderCssClass="tr-ng-sort-order-reverse glyphicon glyphicon-chevron-down ";this.columnSortNormalOrderCssClass="tr-ng-sort-order-normal glyphicon glyphicon-chevron-up ";this.rowSelectedCssClass="active ";this.footerCssClass="tr-ng-grid-footer form-inline "}return n}(),t=function(){function n(){this.fieldName=undefined;this.cellWidth=undefined;this.cellHeight=undefined;this.displayAlign="left";this.displayFormat=undefined;this.displayName=undefined;this.filter=undefined;this.enableFiltering=!0;this.enableSorting=!0}return n}(),i,f;n.GridConfigurationDefaultColumnOptions=t;i=function(){function t(t,i){var r=t.startSymbol(),u=t.endSymbol();this.headerCellStandard="<th><\/th>";this.headerCellContentsStandard="<div>  <div "+n.Constants.columnSortDirectiveAttribute+'=""><\/div>  <a '+i.columnTitleCssClass+'"     href="" ng-click="((gridOptions.enableSorting&&gridColumnOptions.enableSorting!==false)||gridColumnOptions.enableSorting)&&toggleSorting(gridColumnOptions.fieldName)">      '+r+"gridColumnOptions.columnTitle |"+n.Constants.translateFilter+":gridOptions.locale"+u+"  <\/a>  <div "+n.Constants.columnFilterDirectiveAttribute+'=""><\/div><\/div>';this.bodyCellStandard="<td><\/td>";this.bodyCellContentsStandard="<div>  "+r+"gridDisplayItem[columnOptions.displayFieldName]"+u+"<\/div><\/div>";this.footerCellStandard='<div class="'+i.footerCssClass+'" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""><\/div>  <\/div>  <div ng-switch-default>    <span '+n.Constants.globalFilterDirectiveAttribute+'=""><\/span>    <span '+n.Constants.pagerDirectiveAttribute+'=""><\/span>  <\/div><\/div>';this.columnFilter='<div ng-show="(gridOptions.enableFiltering&&columnOptions.enableFiltering!==false)||columnOptions.enableFiltering" class="'+i.columnFilterCssClass+'"> <div class="'+i.columnFilterInputWrapperCssClass+'">   <input class="form-control input-sm" type="text" ng-model="columnOptions.filter" ng-keypress="speedUpAsyncDataRetrieval($event)"><\/input> <\/div><\/div>';this.columnSort='<a href="" ng-attr-title="{{\'Sort\'|'+n.Constants.translateFilter+':gridOptions.locale}}" ng-show="(gridOptions.enableSorting&&columnOptions.enableSorting!==false)||columnOptions.enableSorting" ng-click="toggleSorting(columnOptions.fieldName)" class="'+i.columnSortCssClass+'" >   <span ng-class="{\''+i.columnSortActiveCssClass+"':gridOptions.orderBy==columnOptions.fieldName,'"+i.columnSortInactiveCssClass+"':gridOptions.orderBy!=columnOptions.fieldName,'"+i.columnSortNormalOrderCssClass+"':gridOptions.orderBy==columnOptions.fieldName&&!gridOptions.orderByReverse,'"+i.columnSortReverseOrderCssClass+"':gridOptions.orderBy==columnOptions.fieldName&&gridOptions.orderByReverse}\" >  <\/span><\/a>";this.footerGlobalFilter='<span ng-show="gridOptions.enableFiltering" class="pull-left form-group">  <input class="form-control" type="text" ng-model="gridOptions.filterBy" ng-keypress="speedUpAsyncDataRetrieval($event)" ng-attr-placeholder="{{\'Search\'|'+n.Constants.translateFilter+':gridOptions.locale}}"><\/input><\/span>';this.footerPager='<span class="pull-right form-group"> <ul class="pagination">   <li ng-class="{disabled:gridOptions.currentPage==0}" ng-if="isPaged&&!pageRangeFullCoverage">     <a href="" ng-click="gridOptions.currentPage!=0&&navigateToPage(0)" ng-attr-title="{{\'First Page\'|'+n.Constants.translateFilter+':gridOptions.locale}}">         <span>&laquo;<\/span>     <\/a>   <\/li>   <li ng-class="{disabled:gridOptions.currentPage==0}" ng-if="isPaged&&!pageRangeFullCoverage">     <a href="" ng-click="gridOptions.currentPage!=0&&navigateToPage(gridOptions.currentPage - 1)" ng-attr-title="{{\'Previous Page\'|'+n.Constants.translateFilter+':gridOptions.locale}}">         <span>&lsaquo;<\/span>     <\/a>   <\/li>   <li ng-if="isPaged&&!pageRangeFullCoverage&&visiblePageRange[0]!=0"class="disabled">      <span>...<\/span>   <\/li>   <li ng-if="isPaged" ng-repeat="pageIndex in visiblePageRange track by $index" ng-class="{active:pageIndex===gridOptions.currentPage}">      <a href="" ng-click="navigateToPage(pageIndex)" ng-attr-title="{{\'Page\'|'+n.Constants.translateFilter+':gridOptions.locale}}">{{pageIndex+1}}<\/a>   <\/li>   <li ng-if="isPaged&&!pageRangeFullCoverage&&visiblePageRange[visiblePageRange.length-1]!=lastPage" class="disabled">      <span>...<\/span>   <\/li>   <li ng-class="{disabled:gridOptions.currentPage==lastPage}" ng-if="isPaged&&!pageRangeFullCoverage">     <a href="" ng-click="gridOptions.currentPage!=lastPage&&navigateToPage(gridOptions.currentPage + 1)" ng-attr-title="{{\'Next Page\'|'+n.Constants.translateFilter+':gridOptions.locale}}">         <span>&rsaquo;<\/span>     <\/a>   <\/li>   <li ng-class="{disabled:gridOptions.currentPage==lastPage}" ng-if="isPaged&&!pageRangeFullCoverage">     <a href="" ng-click="gridOptions.currentPage!=lastPage&&navigateToPage(lastPage)" ng-attr-title="{{\'Last Page\'|'+n.Constants.translateFilter+':gridOptions.locale}}">         <span>&raquo;<\/span>     <\/a>   <\/li>   <li class="disabled" style="white-space: nowrap;">     <span ng-hide="totalItemsCount">{{\'No items to display\'|'+n.Constants.translateFilter+":gridOptions.locale}}<\/span>     <span ng-show=\"totalItemsCount\">       {{visibleStartItemIndex+1}} - {{visibleEndItemIndex+1}} {{'displayed'|"+n.Constants.translateFilter+":gridOptions.locale}}       <span>, {{totalItemsCount}} {{'in total'|"+n.Constants.translateFilter+":gridOptions.locale}}<\/span>     <\/span >    <\/li> <\/ul><\/span>"}return t}();f=function(){function f(n){var t=this;this.$interpolateProvider=n;this.$get=[function(){return{styles:t.styles(),defaultColumnOptions:t.defaultColumnOptions(),translations:t.gridTranslations,pagerOptions:t.pagerOptions(),templates:t.templates(),debugMode:t.debugMode()}}];this.gridTranslations={};this.gridDebugMode=!0}return f.prototype.styles=function(n){return n&&(this.gridStyles=angular.extend({},new u,n)),angular.extend({},this.gridStyles||new u)},f.prototype.defaultColumnOptions=function(n){return n&&(this.gridDefaultColumnOptions=angular.extend({},new t,n)),angular.extend({},this.gridDefaultColumnOptions||new t)},f.prototype.translations=function(n,t){var i=this.gridTranslations[n]=angular.extend({},this.gridTranslations[n],t);return angular.extend({},i)},f.prototype.defaultTranslations=function(t){return this.translations(n.Constants.defaultTranslationLocale,t)},f.prototype.pagerOptions=function(n){return n&&(this.gridPagerOptions=angular.extend({},new r,n)),angular.extend({},this.gridPagerOptions||new r)},f.prototype.templates=function(n){return n&&(this.gridTemplates=angular.extend({},new i(this.$interpolateProvider,this.styles()),n)),angular.extend({},this.gridTemplates||new i(this.$interpolateProvider,this.styles()))},f.prototype.debugMode=function(n){return n!==undefined&&(this.gridDebugMode=!!n),this.gridDebugMode},f}();n.gridModule.provider(n.Constants.gridConfigurationService,["$interpolateProvider",function(n){return new f(n)}])}(TrNgGrid||(TrNgGrid={})),function(n){var e,t,i,r,u,f;(function(n){n[n.Enforced=0]="Enforced";n[n.Header=1]="Header";n[n.Body=2]="Body";n[n.Footer=3]="Footer"})(n.GridSectionType||(n.GridSectionType={}));e=n.GridSectionType;t=function(){function n(){this.fieldName=undefined;this.colspan=undefined;this.isCustomized=undefined;this.isAutoGenerated=undefined;this.isLinkedToField=undefined;this.isDeactivated=undefined;this.placeholder=undefined}return n}();n.DefaultGridColumnLayoutOptions=t;i=function(){function n(n,t,i,r){this.gridConfiguration=n;this.loggingService=t;this.gridLayout=i;this.gridSectionType=r;this.cells=[]}return n.prototype.swapCells=function(n,t){var i=this.cells[n],r=this.cells[t];this.gridConfiguration.debugMode&&this.loggingService.log("About to swap cells ["+i.fieldName+"] and ["+r.fieldName+"] in section "+this.gridSectionType,this);this.cells.splice(n,1,r);this.cells.splice(t,1,i)},n.prototype.findCell=function(n){for(var t=0;t<this.cells.length;t++)if(this.cells[t].fieldName===n)return this.cells[t];return null},n.prototype.registerCell=function(n,t){var r,i;if(!n.fieldName)throw"A field name was not provided";if(r=!1,t===undefined)for(i=0;i<this.cells.length&&!r;i++)this.cells[i].fieldName===n.fieldName&&(this.gridConfiguration.debugMode&&this.loggingService.log("A layout cell [",n.fieldName,n,"] is about to be updated in section ",this.gridSectionType,this),this.cells[i]=n,r=!0);r||(this.gridConfiguration.debugMode&&this.loggingService.log("A new layout cell [",n.fieldName,n,"] is about to be registered in section ",this.gridSectionType,this),t===undefined||t===this.cells.length?this.cells.push(n):this.cells.splice(t,0,n));this.gridLayout.triggerReconciliation()},n.prototype.unregisterCell=function(n){for(var t=0;t<this.cells.length;t++)if(this.cells[t]===n){this.gridConfiguration.debugMode&&this.loggingService.log("A layout cell [",n,"] is about to get unregistered in section ",this);this.cells.splice(t,1);this.gridLayout.triggerReconciliation();return}},n}();n.GridLayoutRow=i;r=function(){function n(n,t,i,r){this.gridConfiguration=n;this.loggingService=t;this.gridLayout=i;this.gridSectionType=r;this.rows=[]}return n.prototype.registerRow=function(){var n=new i(this.gridConfiguration,this.loggingService,this.gridLayout,this.gridSectionType);return this.rows.push(n),this.gridConfiguration.debugMode&&this.loggingService.log("A new layout row [",n,"] was registered in section ",this),this.gridLayout.triggerReconciliation(),n},n.prototype.unregisterRow=function(n){for(var t=0;t<this.rows.length;t++)if(this.rows[t]===n){this.rows.splice(t,1);this.gridConfiguration.debugMode&&this.loggingService.log("A layout row [",n,"] was unregistered from section ",this);this.gridLayout.triggerReconciliation();return}},n.prototype.clear=function(){this.rows.splice(0);this.gridConfiguration.debugMode&&this.loggingService.log("Layout section ",this," got cleared");this.gridLayout.triggerReconciliation()},n}();n.GridLayoutSection=r;u=function(){function i(n,t,i){this.gridConfiguration=n;this.loggingService=t;this.gridOptions=i;this.sections=new Array(3);this.reconciliationTriggerKey="triggerGridReconciliation";this.reconciling=!1;this.setupListeners()}return i.prototype.getSection=function(n){var t=this.sections[n];return t||(this.sections[n]=t=new r(this.gridConfiguration,this.loggingService,this,n),this.gridConfiguration.debugMode&&this.loggingService.log("A new layout section ["+n+"] was registered"),this.triggerReconciliation()),t},i.prototype.triggerReconciliation=function(){this.gridOptions[this.reconciliationTriggerKey]=!0},i.prototype.setupListeners=function(){var i=this,t;this.gridOptions.$watch(this.reconciliationTriggerKey,function(n){n&&i.gridOptions.$applyAsync(function(){i.reconcile()})});t=null;t=this.gridOptions.$watch("items.length",function(r){r&&(i.enforceFields(n.extractFields(i.gridOptions.items[0])),t&&(t(),t=null))});this.gridOptions.fields&&(this.enforceFields(this.gridOptions.fields),t&&(t(),t=null));this.gridOptions.$watchCollection("fields",function(n,r){angular.equals(n,r)||(i.enforceFields(n||[]),t&&(t(),t=null))})},i.prototype.enforceFields=function(n){var i=this.getSection(0),r;n?(i.clear(),r=i.registerRow(),angular.forEach(n,function(n){var i=new t;i.fieldName=n;i.isAutoGenerated=!0;i.isLinkedToField=!0;r.registerCell(i)})):i.clear()},i.prototype.reconcile=function(){var u=this,r,n,t,i;try{for(this.gridConfiguration.debugMode&&this.loggingService.log("Starting to reconcile all the rows"),r=[],n=0;n<=1&&r.length===0;n++)angular.forEach(this.getSection(n).rows,function(n){angular.forEach(n.cells,function(n){n.isLinkedToField&&r.push(n.fieldName)})});for(t=[],n=0;n<=2;n++)angular.forEach(this.getSection(n).rows,function(i){n!==0&&u.cleanupRowForReconciliation(i,r);t.push(i)});for(i=0;i<t.length-1;i++)this.reconcileRows(t[i],t[i+1])}finally{this.gridOptions[this.reconciliationTriggerKey]=!1}},i.prototype.reconcileRows=function(n,t){for(var f,e,i,u,o,r=0,s=0;s<n.cells.length;s++)if(f=n.cells[s],!f.isDeactivated){for(e=!0,u=r;e&&u<t.cells.length;u++)i=t.cells[u],!i||i.isDeactivated||i.isLinkedToField!=f.isLinkedToField||i.isLinkedToField&&i.fieldName!==f.fieldName||(e=!1);e?(i=angular.extend({},f),i.isAutoGenerated=!0,i.isCustomized=!1,t.registerCell(i,r)):(u--,u!==r&&t.swapCells(u,r));r++}while(r<t.cells.length)o=t.cells[r],o.isAutoGenerated?t.unregisterCell(o):(o.isDeactivated=!0,r++)},i.prototype.cleanupRowForReconciliation=function(n,t){for(var i,r=0;r<n.cells.length;r++)i=n.cells[r],i.isAutoGenerated?(n.unregisterCell(i),r--):i.isDeactivated=i.isLinkedToField&&t.indexOf(i.fieldName)<0},i}();n.GridLayout=u;f=function(){function i(){}return i.prototype.prepareColumnSettingsScope=function(i,r){var u=this,f=!1;n.monitorScope(r,new n.GridConfigurationDefaultColumnOptions,function(e){u.registerColumnOptions(i,e);f||(n.monitorScope(r,new t,function(n){n.isLinkedToField=i.gridColumnOptions.isLinkedToField;u.registerColumnLayoutOptions(i,n)}),f=!0)})},i.prototype.prepareAutoGeneratedColumnScope=function(n){if(!n.gridColumnLayout)throw"Expecting a grid column layout for the auto-generated cell";n.gridColumnOptions=n.grid.getColumnOptions(n.gridColumnLayout.fieldName);n.gridColumnOptions||(n.gridColumnOptions={fieldName:n.gridColumnLayout.fieldName},n.grid.setColumnOptions(n.gridColumnOptions))},i.prototype.registerColumnOptions=function(n,t){t=n.grid.setColumnOptions(t);n.gridColumnOptions=t},i.prototype.registerColumnLayoutOptions=function(n,t){t.isAutoGenerated?t=n.gridLayoutRow.findCell(t.fieldName):n.gridLayoutRow.registerCell(t);n.gridColumnLayout=t},i}();n.GridColumnController=f}(TrNgGrid||(TrNgGrid={})),function(n){var t=function(){function t(t,i){this.gridConfiguration=t;this.loggingService=i;this.restrict="A";this.scope={items:"=",selectedItems:"=?",filterBy:"=?",filterByFields:"=?",orderBy:"=?",orderByReverse:"=?",pageItems:"=?",currentPage:"=?",totalItems:"=?",enableFiltering:"=?",enableSorting:"=?",selectionMode:"@",locale:"@",onDataRequired:"&",onDataRequiredDelay:"=?",fields:"=?"};this.controller=["$compile","$parse","$timeout",n.Constants.gridConfigurationService,n.Constants.gridLoggingService,n.GridController]}return t.prototype.fixTableStructure=function(t){var f=this,i=n.findChildByTagName(t,"thead"),r,u;i||(i=n.findChildByTagName(angular.element("<table><thead><\/thead><\/table"),"thead"),t.prepend(i));i.attr(n.Constants.sectionDirectiveAttribute,"");r=n.findChildByTagName(t,"tfoot");r||(r=n.findChildByTagName(angular.element("<table><tfoot><\/tfoot><\/table"),"tfoot"),i.after(r));u=n.findChildByTagName(t,"tbody");u||(u=n.findChildByTagName(angular.element("<table><tbody><\/tbody><\/table"),"tbody"),r.after(u));u.attr(n.Constants.sectionDirectiveAttribute,"");angular.forEach(t.children,function(n){(n!==i[0]||n!==u[0]||n!==r[0])&&(angular.element(n).remove(),f.gridConfiguration.debugMode&&f.loggingService.log("Invalid extra element found inside the grid template structure: ",n))})},t.prototype.compile=function(n){return this.fixTableStructure(n),n.addClass(this.gridConfiguration.styles.tableCssClass),{pre:function(n,t,i,r){r.setGridOptions(n)}}},t}(),i=function(){function t(t){this.gridConfiguration=t;this.restrict="A";this.scope=!0;this.require="^"+n.Constants.tableDirective}return t.prototype.fixGridSection=function(t,i){var r,u=n.findChildrenByTagName(t,"tr"),c,l,e,o,s,h,y;for(u.length||(t.empty(),r=n.createRowElement(),t.append(r),u.push(r)),c=i===n.GridSectionType.Header?"th":"td",l=n.getStandardCellTemplate(this.gridConfiguration,i),e=0;e<u.length;e++)for(r=u[e],i===n.GridSectionType.Body&&(e===0&&u.length>1?r.attr("data-ng-repeat-start","gridDisplayItem in gridDisplayItems"):e===u.length-1&&(u.length>1?r.attr("data-ng-repeat-end",""):r.attr("data-ng-repeat","gridDisplayItem in gridDisplayItems"))),r.attr(n.Constants.rowDirectiveAttribute,""),o=n.findChildrenByTagName(r,c),o.length!==0&&o[0].attr(n.Constants.cellPlaceholderDirectiveAttribute)||(s=l,s.attr("data-ng-repeat","gridColumnLayout in (gridLayoutRow.cells)"),s.attr(n.Constants.cellPlaceholderDirectiveAttribute,""),r.prepend(s)),h=0;h<o.length;h++){var f=o[h],a=f.children(),v=a.length||f.html().replace(/^\s+|\s+$/gm,"");v&&a.length===0&&(y=angular.element("<div>"+f.html()+"<\/div>"),f.empty(),f.append(y));v&&f.attr(n.Constants.dataColumnIsCustomizedAttribute,"true");f.attr(n.Constants.cellDirectiveAttribute,"true")}},t.prototype.compile=function(t){var i,r=t.prop("tagName");switch(r){case"THEAD":i=n.GridSectionType.Header;break;case"TBODY":i=n.GridSectionType.Body;break;case"TFOOT":i=n.GridSectionType.Footer;break;default:throw"The section element "+r+" is not recognized as a valid TABLE element";}return this.fixGridSection(t,i),{pre:function(n,t,r,u){n.grid=u;n.gridOptions=u.gridOptions;n.gridLayoutSection=u.gridLayout.getSection(i)}}},t}(),r=function(){function t(){this.restrict="A";this.scope=!0;this.require="^"+n.Constants.tableDirective}return t.prototype.compile=function(){return{pre:function(n){n.gridLayoutRow=n.gridLayoutSection.registerRow();n.$on("$destroy",function(){n.gridLayoutSection.unregisterRow(n.gridLayoutRow)})},post:function(){}}},t}(),u=function(){function t(t,i,r){this.$compile=t;this.gridConfiguration=i;this.loggingService=r;this.restrict="A";this.require=[n.Constants.cellPlaceholderDirective,"^"+n.Constants.tableDirective];this.controller=[n.GridColumnController];this.transclude="element"}return t.prototype.compile=function(){var t=this;return{pre:function(i,r,u,f){var o;if(i.gridColumnLayout.placeholder=r,o=f[0],i.gridColumnLayout.isAutoGenerated){o.prepareAutoGeneratedColumnScope(i);var h=!1,e=null,s=function(){if(e&&(t.gridConfiguration.debugMode&&t.loggingService.log("Removing auto-generated cell for field "+i.gridColumnLayout.fieldName),e.remove(),e=null),i.gridColumnLayout&&i.gridColumnOptions){t.gridConfiguration.debugMode&&t.loggingService.log("Creating auto-generated cell for field "+i.gridColumnLayout.fieldName);var u=n.getStandardCellTemplate(t.gridConfiguration,i.gridLayoutSection.gridSectionType);u.append(n.getStandardCellContentsTemplate(t.gridConfiguration,i.gridLayoutSection.gridSectionType));r.after(u);e=t.$compile(u)(i)}};i.$watchGroup(["gridColumnLayout","gridColumnOptions"],function(){s()});i.$on("$destroy",function(){h=!0;s();i.gridColumnLayout.placeholder=null})}},post:function(){}}},t}(),f=function(){function t(t,i,r){this.$compile=t;this.gridConfiguration=i;this.loggingService=r;this.restrict="A";this.require=[n.Constants.cellDirective,"^"+n.Constants.tableDirective];this.controller=[n.GridColumnController];this.scope={isCustomized:"@"+n.Constants.dataColumnIsCustomizedField,fieldName:"@",displayName:"@",displayAlign:"@",displayFormat:"@",enableSorting:"@",enableFiltering:"@",cellWidth:"@",cellHeight:"@",filter:"@",colspan:"@"};this.transclude="element";this.replace=!0;this.template='<td style="display:none"><\/td>'}return t.prototype.compile=function(){var i=this,t;return{pre:function(n,i,r,u){var f=u[0];t=n.$parent.$new();f.prepareColumnSettingsScope(t,n)},post:function(r,u,f,e,o){var s=null,h=!1,c=function(){s&&(i.gridConfiguration.debugMode&&i.loggingService.log("Removing tanscluded cell for field ",t.gridColumnLayout.fieldName),s.remove(),s=null);!h&&t.gridColumnLayout&&t.gridColumnLayout.placeholder&&t.gridColumnOptions&&(i.gridConfiguration.debugMode&&i.loggingService.log("Transcluding and attaching cell for field ",t.gridColumnLayout.fieldName),o(t,function(r){if(s=r,t.gridColumnLayout.placeholder.after(s),!t.gridColumnLayout.isCustomized){var u=angular.element(n.getStandardCellContentsTemplate(i.gridConfiguration,t.gridLayoutSection.gridSectionType));s.append(u);i.$compile(u)(t)}}))};t.$watchGroup(["gridColumnLayout","gridColumnOptions","gridColumnLayout.placeholder"],function(){c()});r.$on("$destroy",function(){h=!0;c();t.$destroy()})}}},t}();n.gridModule.directive(n.Constants.tableDirective,[n.Constants.gridConfigurationService,n.Constants.gridLoggingService,function(n,i){return new t(n,i)}]);n.gridModule.directive(n.Constants.sectionDirective,[n.Constants.gridConfigurationService,function(n){return new i(n)}]);n.gridModule.directive(n.Constants.rowDirective,[function(){return new r}]);n.gridModule.directive(n.Constants.cellPlaceholderDirective,["$compile",n.Constants.gridConfigurationService,n.Constants.gridLoggingService,function(n,t,i){return new u(n,t,i)}]);n.gridModule.directive(n.Constants.cellDirective,["$compile",n.Constants.gridConfigurationService,n.Constants.gridLoggingService,function(n,t,i){return new f(n,t,i)}])}(TrNgGrid||(TrNgGrid={})),function(n){n.gridModule.filter(n.Constants.sortFilter,["$filter","$parse",function(n,t){return function(i,r,u){if(!r.orderBy||!u)return i;return n("orderBy")(i,function(n){var i=undefined;try{i=t("item.trNgGridDataItem."+r.orderBy)({item:n})}catch(f){}if(i===undefined)try{i=t("item."+u.displayItemFieldName)({item:n})}catch(f){}return i},r.orderByReverse)}}]).filter(n.Constants.dataPagingFilter,function(){return function(n,t){var i,r;return(n&&(t.totalItems=n.length),!t.pageItems||!n||n.length===0)?n:(t.currentPage||(t.currentPage=0),i=t.currentPage*t.pageItems,i>=n.length&&(t.currentPage=0,i=0),r=t.currentPage*t.pageItems+t.pageItems,n.slice(i,r))}}).filter(n.Constants.translateFilter,["$filter","$injector",n.Constants.gridConfigurationService,function(t,i,r){function u(t,i){for(var s,e,f=null,o=t.split(/[-_]/),u=o.length;u>=0&&!f;u--)s=u===0?n.Constants.defaultTranslationLocale:o.slice(0,u).join("-"),e=r.translations[s],e&&(f=i(e));return f}return function(r,f){var e,o;if(!r)return r;if(f||(f=n.Constants.defaultTranslationLocale),r instanceof Date)return o=u(f,function(n){return n.localeDateFormat}),t("date")(r,o);if(e=u(f,function(n){return n[r]}),!e&&i.has("translateFilter"))try{e=t("translate")(r)}catch(s){}return e||(e=r),e}}])}(TrNgGrid||(TrNgGrid={}));